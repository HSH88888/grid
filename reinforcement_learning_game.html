
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê°•í™”í•™ìŠµ Grid World ì‹œë®¬ë ˆì´ì…˜</title>
<style>
body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
display: flex;
flex-direction: column;
align-items: center;
padding: 20px;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
min-height: 100vh;
margin: 0;
}
.container {
background: white;
padding: 30px;
border-radius: 15px;
box-shadow: 0 10px 40px rgba(0,0,0,0.3);
max-width: 1000px;
width: 100%;
}
h1 {
color: #333;
text-align: center;
margin-bottom: 10px;
}
.subtitle {
text-align: center;
color: #666;
margin-bottom: 20px;
}
#grid {
display: grid;
gap: 2px;
background: #333;
padding: 2px;
margin: 20px auto;
border-radius: 8px;
box-shadow: 0 4px 15px rgba(0,0,0,0.2);
width: fit-content;
}
.cell {
width: 50px;
height: 50px;
display: flex;
align-items: center;
justify-content: center;
font-size: 20px;
background: white;
transition: background 0.2s;
position: relative;
}
.cell.agent {
background: #4CAF50;
color: white;
}
.cell.goal {
background: #FFD700;
}
.cell.obstacle {
background: #f44336;
}
.cell.visited {
background: #E3F2FD;
}
.controls {
display: flex;
gap: 10px;
justify-content: center;
margin: 20px 0;
flex-wrap: wrap;
}
button {
padding: 12px 24px;
font-size: 16px;
cursor: pointer;
border: none;
border-radius: 6px;
background: #667eea;
color: white;
transition: all 0.3s;
font-weight: 600;
}
button:hover {
background: #5568d3;
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}
button:disabled {
background: #ccc;
cursor: not-allowed;
transform: none;
}
button:active {
transform: translateY(0);
}
.stats {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 15px;
margin: 20px 0;
}
.stat-box {
background: #f5f5f5;
padding: 15px;
border-radius: 8px;
text-align: center;
}
.stat-label {
color: #666;
font-size: 14px;
margin-bottom: 5px;
}
.stat-value {
color: #333;
font-size: 24px;
font-weight: bold;
}
.info {
background: #e3f2fd;
padding: 15px;
border-radius: 8px;
margin: 15px 0;
border-left: 4px solid #2196F3;
font-size: 14px;
}
.legend {
display: flex;
gap: 20px;
justify-content: center;
margin: 15px 0;
flex-wrap: wrap;
}
.legend-item {
display: flex;
align-items: center;
gap: 8px;
}
.legend-box {
width: 30px;
height: 30px;
border-radius: 4px;
border: 2px solid #333;
}
.speed-control {
display: flex;
align-items: center;
gap: 10px;
justify-content: center;
margin: 15px 0;
}
input[type="range"] {
width: 200px;
}
.grid-settings {
background: #f5f5f5;
padding: 15px;
border-radius: 8px;
margin: 15px 0;
}
.grid-size-buttons {
display: flex;
gap: 10px;
justify-content: center;
flex-wrap: wrap;
margin: 10px 0;
}
.grid-size-buttons button {
padding: 8px 16px;
font-size: 14px;
}
.obstacle-settings {
background: #fff3cd;
padding: 15px;
border-radius: 8px;
margin: 15px 0;
border-left: 4px solid #FF9800;
}
.setting-row {
display: flex;
gap: 10px;
align-items: center;
justify-content: center;
margin: 10px 0;
flex-wrap: wrap;
}
select, input[type="number"] {
padding: 8px;
border-radius: 4px;
border: 1px solid #ddd;
font-size: 14px;
}
@media (max-width: 768px) {
.container {
padding: 15px;
}
.cell {
width: 40px;
height: 40px;
font-size: 18px;
}
button {
padding: 10px 18px;
font-size: 14px;
}
.stat-value {
font-size: 20px;
}
}
@media (max-width: 480px) {
.cell {
width: 30px;
height: 30px;
font-size: 14px;
}
}
</style>
</head>
<body>
<div class="container">
<h1>ğŸ¤– ê°•í™”í•™ìŠµ Grid World</h1>
<p class="subtitle">Q-Learning ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì—ì´ì „íŠ¸ê°€ ëª©í‘œë¥¼ ì°¾ëŠ” ê³¼ì •ì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤</p>

<div class="grid-settings">
<div class="setting-row">
<strong>ê·¸ë¦¬ë“œ í¬ê¸°:</strong>
</div>
<div class="grid-size-buttons">
<button onclick="changeGridSize(6)">6Ã—6</button>
<button onclick="changeGridSize(8)">8Ã—8</button>
<button onclick="changeGridSize(10)">10Ã—10</button>
<button onclick="changeGridSize(12)">12Ã—12</button>
<button onclick="changeGridSize(15)">15Ã—15</button>
<button onclick="changeGridSize(20)">20Ã—20</button>
</div>
</div>

<div class="obstacle-settings">
<div class="setting-row">
<strong>ğŸ² ëœë¤ ì¥ì• ë¬¼:</strong>
<select id="obstacleCount">
<option value="5">5ê°œ</option>
<option value="10" selected>10ê°œ</option>
<option value="15">15ê°œ</option>
<option value="20">20ê°œ</option>
<option value="30">30ê°œ</option>
</select>
<button onclick="generateRandomObstacles()" style="background: #FF9800;">ëœë¤ ìƒì„±</button>
<button onclick="clearObstacles()" style="background: #f44336;">ì¥ì• ë¬¼ ì œê±°</button>
</div>
</div>

<div class="legend">
<div class="legend-item">
<div class="legend-box" style="background: #4CAF50;"></div>
<span>ì—ì´ì „íŠ¸</span>
</div>
<div class="legend-item">
<div class="legend-box" style="background: #FFD700;"></div>
<span>ëª©í‘œ</span>
</div>
<div class="legend-item">
<div class="legend-box" style="background: #f44336;"></div>
<span>ì¥ì• ë¬¼</span>
</div>
<div class="legend-item">
<div class="legend-box" style="background: #E3F2FD;"></div>
<span>ë°©ë¬¸ ê²½ë¡œ</span>
</div>
</div>

<div id="grid"></div>

<div class="stats">
<div class="stat-box">
<div class="stat-label">ì—í”¼ì†Œë“œ</div>
<div class="stat-value" id="episode">0</div>
</div>
<div class="stat-box">
<div class="stat-label">ìŠ¤í…</div>
<div class="stat-value" id="steps">0</div>
</div>
<div class="stat-box">
<div class="stat-label">ì´ ë³´ìƒ</div>
<div class="stat-value" id="reward">0</div>
</div>
<div class="stat-box">
<div class="stat-label">ì„±ê³µë¥ </div>
<div class="stat-value" id="success">0%</div>
</div>
</div>

<div class="speed-control">
<label for="speed">í•™ìŠµ ì†ë„:</label>
<input type="range" id="speed" min="1" max="100" value="50">
<span id="speedValue">50ms</span>
</div>

<div class="controls">
<button id="trainBtn" onclick="startTraining()">ğŸ“ í•™ìŠµ ì‹œì‘</button>
<button id="stopBtn" onclick="stopTraining()" disabled>â¸ï¸ ì¼ì‹œì •ì§€</button>
<button id="resetBtn" onclick="resetEnvironment()">ğŸ”„ ì´ˆê¸°í™”</button>
<button id="testBtn" onclick="testAgent()">ğŸ¯ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
</div>

<div class="info">
<strong>ğŸ“š ì‘ë™ ì›ë¦¬:</strong><br>
â€¢ <strong>Q-Learning</strong>: ì—ì´ì „íŠ¸ê°€ ìƒíƒœ-í–‰ë™ ê°€ì¹˜ë¥¼ í•™ìŠµí•©ë‹ˆë‹¤<br>
â€¢ <strong>íƒí—˜ vs í™œìš©</strong>: Îµ-greedy ì „ëµìœ¼ë¡œ ìƒˆë¡œìš´ ê²½ë¡œë¥¼ íƒìƒ‰í•˜ê±°ë‚˜ í•™ìŠµí•œ ì§€ì‹ì„ í™œìš©í•©ë‹ˆë‹¤<br>
â€¢ <strong>ë³´ìƒ ì‹œìŠ¤í…œ</strong>: ëª©í‘œ ë„ë‹¬ ì‹œ +100, ì¥ì• ë¬¼ -100, ê° ìŠ¤í…ë§ˆë‹¤ -1<br>
â€¢ <strong>í•™ìŠµë¥ (Î±)</strong>: 0.1, <strong>í• ì¸ìœ¨(Î³)</strong>: 0.9, <strong>íƒí—˜ìœ¨(Îµ)</strong>: 0.1
</div>
</div>

<script>
let GRID_SIZE = 6;
const ACTIONS = ['up', 'down', 'left', 'right'];
let qTable = {};
let agent = { x: 0, y: 0 };
let goal = { x: 5, y: 5 };
let obstacles = [
{ x: 1, y: 1 }, { x: 2, y: 2 }, { x: 3, y: 1 },
{ x: 1, y: 3 }, { x: 4, y: 3 }
];
let episode = 0;
let steps = 0;
let totalReward = 0;
let successCount = 0;
let isTraining = false;
let currentStepInterval = null;
let visitedCells = new Set();

const alpha = 0.1; // í•™ìŠµë¥ 
const gamma = 0.9; // í• ì¸ìœ¨
let epsilon = 0.1; // íƒí—˜ìœ¨

function changeGridSize(size) {
GRID_SIZE = size;
goal = { x: size - 1, y: size - 1 };
generateRandomObstacles();
resetEnvironment();
}

function generateRandomObstacles() {
const count = parseInt(document.getElementById('obstacleCount').value);
obstacles = [];

for (let i = 0; i < count; i++) {
let x, y;
let attempts = 0;
do {
x = Math.floor(Math.random() * GRID_SIZE);
y = Math.floor(Math.random() * GRID_SIZE);
attempts++;
} while (
attempts < 100 && (
(x === 0 && y === 0) || // ì‹œì‘ì  ì•„ë‹˜
(x === goal.x && y === goal.y) || // ëª©í‘œì  ì•„ë‹˜
obstacles.some(obs => obs.x === x && obs.y === y) // ì¤‘ë³µ ì•„ë‹˜
)
);
if (attempts < 100) {
obstacles.push({ x, y });
}
}
initGrid();
updateDisplay();
}

function clearObstacles() {
obstacles = [];
initGrid();
updateDisplay();
}

function initGrid() {
const grid = document.getElementById('grid');
grid.style.gridTemplateColumns = `repeat(${GRID_SIZE}, 50px)`;
grid.innerHTML = '';

for (let y = 0; y < GRID_SIZE; y++) {
for (let x = 0; x < GRID_SIZE; x++) {
const cell = document.createElement('div');
cell.className = 'cell';
cell.id = `cell-${x}-${y}`;

if (x === agent.x && y === agent.y) {
cell.classList.add('agent');
cell.textContent = 'ğŸ¤–';
} else if (x === goal.x && y === goal.y) {
cell.classList.add('goal');
cell.textContent = 'ğŸ¯';
} else if (obstacles.some(obs => obs.x === x && obs.y === y)) {
cell.classList.add('obstacle');
cell.textContent = 'ğŸš«';
}

grid.appendChild(cell);
}
}
}

function getStateKey(x, y) {
return `${x},${y}`;
}

function getQValue(state, action) {
const key = `${state}-${action}`;
return qTable[key] || 0;
}

function setQValue(state, action, value) {
const key = `${state}-${action}`;
qTable[key] = value;
}

function chooseAction(state) {
if (Math.random() < epsilon) {
return ACTIONS[Math.floor(Math.random() * ACTIONS.length)];
}

let bestAction = ACTIONS[0];
let bestValue = getQValue(state, bestAction);

for (let action of ACTIONS) {
const value = getQValue(state, action);
if (value > bestValue) {
bestValue = value;
bestAction = action;
}
}
return bestAction;
}

function takeAction(action) {
let newX = agent.x;
let newY = agent.y;

switch(action) {
case 'up': newY = Math.max(0, newY - 1); break;
case 'down': newY = Math.min(GRID_SIZE - 1, newY + 1); break;
case 'left': newX = Math.max(0, newX - 1); break;
case 'right': newX = Math.min(GRID_SIZE - 1, newX + 1); break;
}

let reward = -1;
let done = false;

if (obstacles.some(obs => obs.x === newX && obs.y === newY)) {
reward = -100;
done = true;
} else if (newX === goal.x && newY === goal.y) {
reward = 100;
done = true;
successCount++;
} else {
agent.x = newX;
agent.y = newY;
visitedCells.add(getStateKey(newX, newY));
}

return { newX, newY, reward, done };
}

function updateQValue(state, action, reward, nextState) {
const currentQ = getQValue(state, action);

let maxNextQ = -Infinity;
for (let nextAction of ACTIONS) {
const q = getQValue(nextState, nextAction);
if (q > maxNextQ) maxNextQ = q;
}

const newQ = currentQ + alpha * (reward + gamma * maxNextQ - currentQ);
setQValue(state, action, newQ);
}

function updateDisplay() {
for (let y = 0; y < GRID_SIZE; y++) {
for (let x = 0; x < GRID_SIZE; x++) {
const cell = document.getElementById(`cell-${x}-${y}`);
if (!cell) continue;
cell.className = 'cell';
cell.textContent = '';

if (visitedCells.has(getStateKey(x, y))) {
cell.classList.add('visited');
}

if (x === agent.x && y === agent.y) {
cell.classList.add('agent');
cell.textContent = 'ğŸ¤–';
} else if (x === goal.x && y === goal.y) {
cell.classList.add('goal');
cell.textContent = 'ğŸ¯';
} else if (obstacles.some(obs => obs.x === x && obs.y === y)) {
cell.classList.add('obstacle');
cell.textContent = 'ğŸš«';
}
}
}

document.getElementById('episode').textContent = episode;
document.getElementById('steps').textContent = steps;
document.getElementById('reward').textContent = Math.round(totalReward);
const successRate = episode > 0 ? Math.round((successCount / episode) * 100) : 0;
document.getElementById('success').textContent = successRate + '%';
}

function runEpisode() {
agent.x = 0;
agent.y = 0;
visitedCells.clear();
visitedCells.add(getStateKey(0, 0));

let episodeSteps = 0;
let episodeReward = 0;
const maxSteps = GRID_SIZE * GRID_SIZE * 2;

if (currentStepInterval) {
clearInterval(currentStepInterval);
}

currentStepInterval = setInterval(() => {
const state = getStateKey(agent.x, agent.y);
const action = chooseAction(state);
const result = takeAction(action);

episodeSteps++;
steps++;
episodeReward += result.reward;
totalReward += result.reward;

const nextState = getStateKey(result.newX, result.newY);
updateQValue(state, action, result.reward, nextState);

updateDisplay();

if (result.done || episodeSteps >= maxSteps) {
clearInterval(currentStepInterval);
episode++;
if (isTraining) {
setTimeout(runEpisode, 100);
}
}
}, 101 - document.getElementById('speed').value);

if (!isTraining) {
clearInterval(currentStepInterval);
}
}

function startTraining() {
isTraining = true;
document.getElementById('trainBtn').disabled = true;
document.getElementById('stopBtn').disabled = false;
document.getElementById('testBtn').disabled = true;
epsilon = 0.1;
runEpisode();
}

function stopTraining() {
isTraining = false;
if (currentStepInterval) {
clearInterval(currentStepInterval);
}
document.getElementById('trainBtn').disabled = false;
document.getElementById('stopBtn').disabled = true;
document.getElementById('testBtn').disabled = false;
}

function resetEnvironment() {
stopTraining();
qTable = {};
agent = { x: 0, y: 0 };
episode = 0;
steps = 0;
totalReward = 0;
successCount = 0;
visitedCells.clear();
visitedCells.add(getStateKey(0, 0));
initGrid();
updateDisplay();
}

function testAgent() {
stopTraining();
epsilon = 0;
agent.x = 0;
agent.y = 0;
visitedCells.clear();
runEpisode();
}

document.getElementById('speed').addEventListener('input', (e) => {
document.getElementById('speedValue').textContent = (101 - e.target.value) + 'ms';
});

// ì´ˆê¸°í™”
initGrid();
updateDisplay();
</script>
</body>
</html>
